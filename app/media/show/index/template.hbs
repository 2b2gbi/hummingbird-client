{{! Ratings }}
<section>
  {{media/components/media-rating
    entry=entry
    media=media
    update=(route-action "updateEntry" entry "rating")
  }}
</section>

{{! Synopsis }}
<section>
  <h5>Synopsis</h5>
  <p>{{truncate-text media.synopsis max=400}}</p>
</section>

{{! Reviews }}
<section>
  <h5>Popular Reviews</h5>
  {{#if model}}
    <ul class="media-list">
      {{#each model as |review|}}
        {{! TODO - @Josh - Reviews need some style love with dynamic content }}
        <li class="media">
          <div class="media-left">
            <a href={{href-to "users.index" review.user}}>
              <img src={{image review.user.avatar}}>
            </a>
          </div>
          <div class="media-body">
            <small class="media-heading">
              {{! TODO - @vevix - link to review directly }}
              <a href="#">Review by {{review.user.name}}</a>
              {{! TODO - @Josh - Review rating on media page }}
              {{star-rating review.rating readOnly=true}}
            </small>
            <div class="comment-body">
              {{! legacy reviews are from Hummingbird }}
              {{#if review.legacy}}
                <p>{{review.summary}}</p>
                <small>This is a legacy review.</small>
              {{else}}
                {{truncate-text review.contentFormatted max=400}}
              {{/if}}
            </div>

            {{! review likes }}
            <div class="stream-item-activity">
              {{likeable-resource
                resource=review
                likesCount=review.likesCount
                likesCountUpdate=(action (mut review.likesCount))
                showUsers=true
              }}
            </div>
          </div>
        </li>
      {{/each}}
    </ul>
  {{else}}
    {{! TODO @Josh -- empty state for no reviews on media page }}
    <p>No Reviews</p>
  {{/if}}
</section>

{{! Feed }}
<section>
  <h5>Community Feed</h5>
  {{stream-feed
    streamType="media_aggr"
    streamId=(concat (capitalize (model-type media)) "-" media.id)
    readOnly=(not session.hasUser)
    media=media
  }}
</section>
